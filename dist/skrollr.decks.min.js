/**
 * skrollr-decks 0.2.0 (2014-12-05) - Makes fullpage presentation decks.
 * Bogdan Chadkin - https://github.com/TrySound/skrollr-decks
 * Free to use under terms of MIT license
 */

!function(a){"use strict";window.skrollr?window.skrollr.decks=a(window,document,window.skrollr):console.error("`skrollr` not found")}(function(a,b,c){"use strict";function d(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")}function e(a,b){a&&!d(a,b)&&(a.className+=(a.className?" ":"")+b)}function f(a,b){a&&d(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}function g(a){var b,d=c.get(),e=a.deckDelay,f=this.updateSegment.bind(this);this._settings=a,this.getSegments(a.segments),this._segments.length>0?(this.resizeSegments(),this.getNav(a.nav),this.listenAnchors(),d.refresh(),d.on("render",function(a){i(b),b=h(function(){f("up"===a.direction)},e)})):this.invalid=!0}var h=a.setTimeout,i=a.clearTimeout;g.prototype={setActive:function(a,b){var d,g=this._items[a.getAttribute("data-skrollr-decks-index")],h=c.get();d=h.relativeToAbsolute(a,"top","top"),h.animateTo(d+1,{duration:b}),"deck"!==this._activeDeck&&(f(this._activeItem,"skrollr-decks-achor-active"),f(this._activeDeck,"skrollr-deck-active"),e(g,"skrollr-decks-achor-active"),e(a,"skrollr-deck-active"),this._activeItem=g,this._activeDeck=a)},getSegments:function(a){var c,d,e,f,g=[];for("string"==typeof a?c=b.querySelectorAll(a):a.tagName?c=[a]:a.length&&(c=a),e=0,f=c.length;f>e;e++)d=c[e],d.tagName&&(d.id||(d.id="skrollr-deck-"+e),g.push(d));return this._segments=g,g},resizeSegments:function(){function b(){var a,b=d.innerHeight+2+"px";for(a=c.length;a--;)c[a].style.minHeight=b}var c=this._segments,d=a;b(),a.addEventListener("resize",b,!1)},updateSegment:function(b){{var d,e,f;c.get()}d=this._nav.getElementsByClassName("skrollable-between"),e=d[b?0:d.length-1],f=this._segments[e.getAttribute("data-skrollr-decks-index")],(d.length>1||a.innerHeight+2===f.clientHeight)&&this.setActive(f,this._settings.deckDuration)},getNav:function(a){{var c,d;this._segments}return"string"==typeof a?c=b.querySelector(a):a.tagName?c=a:a.length&&a[0].tagName&&(c=a[0]),this._items=[],c?"UL"===c.tagName?(d=c,this.appendLinks(d)):(d=c.getElementsByTagName("ul")[0],d?this.appendLinks(d):(d=this.appendLinks(),c.appendChild(d))):(d=this.appendLinks(),d.className="skrollr-decks-nav",b.body.insertBefore(d,b.body.firstChild)),this._nav=d,d},appendLinks:function(a){var c,d,e,f,g,h=this._segments;for(a?d=a.getElementsByTagName("li"):(a=b.createElement("ul"),d=[]),f=0,g=h.length;g>f;f++)e="#"+h[f].id,c=d[f],c||(c=b.createElement("li"),a.appendChild(c)),h[f].setAttribute("data-skrollr-decks-index",f),c.setAttribute("data-skrollr-decks-index",f),c.setAttribute("data-anchor-target",e),c.innerHTML='<a href="'+e+'">'+c.innerHTML+"</a>",c.hasAttribute("data-top-bottom")||c.setAttribute("data-top-bottom",""),c.hasAttribute("data-bottom-top")||c.setAttribute("data-bottom-top",""),this._items.push(c);return a},listenAnchors:function(){var a=this;a._nav.addEventListener("click",function(b){var c,d,e=b.target,f=e.parentNode;"A"===e.tagName&&f.hasAttribute("data-skrollr-decks-index")&&(c=f.getAttribute("data-skrollr-decks-index"),d=a._segments[c],a.setActive(d,a._settings.gotoDuration)),b.preventDefault()},!1)}};var j={init:function(a){var b,d={segments:".skrollr-deck",nav:".skrollr-decks-nav",gotoDuration:600,deckDuration:300,deckDelay:200,autoScroll:!0},e={};a="object"==typeof a?a:{};for(b in d)d.hasOwnProperty(b)&&(e[b]=a[b]||d[b]);c.init({forceHeight:!1});this._decks||(this._decks=new g(e),this._decks.invalid&&(this._decks=void 0))}};return b.addEventListener("DOMContentLoaded",function(){var a=this.querySelector(".skrollr-decks-init");a&&j.init()},!1),j});